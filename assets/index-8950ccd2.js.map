{"version":3,"file":"index-8950ccd2.js","sources":["../../../core/lib/index.mjs","../../../react/lib/index.mjs"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\n\n// src/selectors.ts\nvar Selectors = {\n  Cell: '[role=\"cell\"],[role=\"gridcell\"],[role=\"columnheader\"],[role=\"rowheader\"],td,th',\n  Row: '[role=\"row\"],tr',\n  RowGroup: '[role=\"rowgroup\"],thead,tbody,tfoot',\n  /** Selector from here: https://github.com/Shopify/polaris/blob/main/polaris-react/src/utilities/focus.ts#L10 */\n  Focusable: 'a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not([aria-disabled=\"true\"]):not([tabindex=\"-1\"]):not(:disabled),*[tabindex]'\n};\n\n// src/index.ts\nvar DataGridNav = class {\n  constructor(config = {}) {\n    this.keys = [];\n    this.debugLog = (functionName, message) => {\n      if (this.debug)\n        console.info(`[${functionName}]: ${message}`);\n    };\n    const { selectors = {}, pageUpDown, debug = false } = config;\n    this.selectors = __spreadValues(__spreadValues({}, Selectors), selectors);\n    this.pageUpDown = pageUpDown;\n    this.keys = [];\n    this.debug = debug;\n    this.disabled = false;\n  }\n  /**\n   * Disables the keyboard listener in cases\n   * that elements inside the grid need to use\n   * arrows keys etc., like select dropdowns\n   */\n  disable() {\n    this.disabled = true;\n  }\n  /**\n   * Enables the keyboard listeners\n   */\n  enable() {\n    this.disabled = false;\n  }\n  isFocusable(el) {\n    return el instanceof HTMLElement || el instanceof SVGElement;\n  }\n  /** Used as a keyboard listener for key up */\n  tableKeyUp() {\n    this.keys = [];\n  }\n  /** Used as a keyboard listener for key down */\n  tableKeyDown(e) {\n    var _a;\n    this.debugLog(\"tableKeyDown\", `Key pressed: ${e.key}`);\n    if (this.disabled) {\n      this.debugLog(\"tableKeyDown\", \"interaction is disabled\");\n      return;\n    }\n    if (\"ArrowDown\" /* ArrowDown */ === e.key || \"ArrowUp\" /* ArrowUp */ === e.key || \"ArrowLeft\" /* ArrowLeft */ === e.key || \"ArrowRight\" /* ArrowRight */ === e.key) {\n      e.preventDefault();\n    }\n    if (this.keys.length === 0 || this.keys[this.keys.length - 1] !== e.key) {\n      this.keys.push(e.key);\n    }\n    if (!(e.target instanceof Element))\n      return;\n    const cell = (_a = e.target.parentElement) == null ? void 0 : _a.closest(\n      `${this.selectors.Cell},${this.selectors.Row}`\n    );\n    if (!cell) {\n      this.debugLog(\"tableKeyDown\", \"cell not found\");\n      return;\n    }\n    if (cell.matches(this.selectors.Cell)) {\n      this.debugLog(\"tableKeyDown\", \"event captured in cell\");\n      this.cellNavigation(e);\n    } else {\n      this.debugLog(\"tableKeyDown\", \"event captured in cell\");\n      this.gridNavigation(e);\n    }\n  }\n  /**\n   * Handles the navigation inside a cell\n   */\n  cellNavigation(e) {\n    if (!(e.target instanceof Element))\n      return;\n    if (e.key === \"Escape\" /* Escape */) {\n      const cell = e.target.closest(this.selectors.Cell);\n      if (cell && this.isFocusable(cell)) {\n        cell.focus();\n        return;\n      }\n    }\n    if (e.key === \"ArrowRight\" /* ArrowRight */ || e.key === \"ArrowDown\" /* ArrowDown */) {\n      const cell = e.target.closest(this.selectors.Cell);\n      if (!cell) {\n        this.debugLog(\"cellNavigation\", \"cell not found\");\n        return;\n      }\n      const focusableWidgets = [\n        ...cell.querySelectorAll(this.selectors.Focusable)\n      ];\n      const widgetIdx = focusableWidgets.findIndex((el) => el === e.target);\n      const nextFocusable = widgetIdx === focusableWidgets.length - 1 ? 0 : widgetIdx + 1;\n      const widgetToFocus = focusableWidgets[nextFocusable];\n      if (this.isFocusable(widgetToFocus)) {\n        widgetToFocus.focus();\n      }\n      return;\n    }\n    if (e.key === \"ArrowLeft\" /* ArrowLeft */ || e.key === \"ArrowUp\" /* ArrowUp */) {\n      const cell = e.target.closest(this.selectors.Cell);\n      if (!cell) {\n        this.debugLog(\"cellNavigation\", \"cell not found\");\n        return;\n      }\n      const focusableWidgets = [\n        ...cell.querySelectorAll(this.selectors.Focusable)\n      ];\n      const widgetIdx = focusableWidgets.findIndex((el) => el === e.target);\n      const previousFocusable = widgetIdx === 0 ? focusableWidgets.length - 1 : widgetIdx - 1;\n      const widgetToFocus = focusableWidgets[previousFocusable];\n      if (this.isFocusable(widgetToFocus)) {\n        widgetToFocus.focus();\n      }\n      return;\n    }\n  }\n  /**\n   * Handles the navigation outside a cell\n   * on the grid level\n   */\n  gridNavigation(e) {\n    var _a;\n    const { target } = e;\n    if (!(e.target instanceof Element))\n      return;\n    if (!(target instanceof Element))\n      return;\n    if (this.keys.length === 1) {\n      if (e.key === \"Enter\" /* Enter */) {\n        const cell = e.target.querySelector(this.selectors.Focusable);\n        if (cell && this.isFocusable(cell)) {\n          cell.focus();\n          e.preventDefault();\n        }\n      }\n      if (e.key === \"ArrowLeft\" /* ArrowLeft */ || e.key === \"ArrowRight\" /* ArrowRight */) {\n        const direction = e.key === \"ArrowLeft\" /* ArrowLeft */ ? \"prev\" : \"next\";\n        const cell = e.target.closest(this.selectors.Cell);\n        if (cell && cell instanceof Element) {\n          const closeFocusable = this.findUntil(\n            direction,\n            cell,\n            this.selectors.Cell\n          );\n          if (closeFocusable) {\n            closeFocusable.focus();\n          }\n        }\n      }\n      if (e.key === \"ArrowDown\" /* ArrowDown */ || e.key === \"ArrowUp\" /* ArrowUp */) {\n        this.verticalCellNavigation(e);\n        return;\n      }\n      if (e.key === \"PageUp\" /* PageUp */ || e.key === \"PageDown\" /* PageDown */) {\n        this.pageCellNavigation(e);\n        return;\n      }\n      if (e.key === \"Home\" /* Home */ || e.key === \"End\" /* End */) {\n        const row = e.target.closest(this.selectors.Row);\n        const rowChildren = [...(row == null ? void 0 : row.children) || []];\n        if (e.key === \"End\")\n          rowChildren.reverse();\n        this.focusOnFirstCell(rowChildren);\n      }\n    } else {\n      const [firstKey, secondKey] = this.keys;\n      if (firstKey === \"Control\" && (secondKey === \"Home\" /* Home */ || secondKey === \"End\" /* End */)) {\n        const row = e.target.closest(this.selectors.Row);\n        const siblings = (_a = row.parentElement) == null ? void 0 : _a.children;\n        if (!siblings) {\n          this.debugLog(\"cellNavigation\", \"siblings not found\");\n          return;\n        }\n        const rowToFocus = secondKey === \"Home\" /* Home */ ? siblings[0] : siblings[siblings.length - 1];\n        const rowChildren = [...(rowToFocus == null ? void 0 : rowToFocus.children) || []];\n        if (secondKey === \"End\" /* End */)\n          rowChildren.reverse();\n        this.focusOnFirstCell(rowChildren);\n      }\n    }\n  }\n  pageCellNavigation(e) {\n    var _a;\n    if (!(e.target instanceof Element))\n      return;\n    const row = e.target.closest(this.selectors.Row);\n    const cell = e.target.closest(this.selectors.Cell);\n    if (row && cell) {\n      const position = this.getColumnIndex(cell);\n      if (position === void 0) {\n        this.debugLog(\"cellNavigation\", \"position not found\");\n        return;\n      }\n      const direction = e.key === \"PageUp\" /* PageUp */ ? \"prev\" : \"next\";\n      const siblings = (_a = row.parentElement) == null ? void 0 : _a.children;\n      if (!siblings) {\n        this.debugLog(\"cellNavigation\", \"siblings not found\");\n        return;\n      }\n      let destinationRow;\n      if (this.pageUpDown) {\n        const methodClbk = direction === \"prev\" ? \"previousSibling\" : \"nextSibling\";\n        let sibling = row[methodClbk];\n        if (sibling === null)\n          return;\n        let lastVisitedSibling = sibling;\n        for (let i = 0; i < this.pageUpDown - 1 && sibling; i++) {\n          sibling = sibling[methodClbk];\n          if (sibling) {\n            lastVisitedSibling = sibling;\n          }\n        }\n        destinationRow = sibling ? sibling : lastVisitedSibling;\n      } else {\n        destinationRow = direction === \"prev\" ? siblings[0] : siblings[siblings.length - 1];\n      }\n      if (!destinationRow || !(destinationRow instanceof Element))\n        return;\n      const child = destinationRow.children[position];\n      if (child && this.isFocusable(child))\n        child.focus();\n    }\n  }\n  verticalCellNavigation(e) {\n    var _a, _b, _c, _d, _e;\n    if (!(e.target instanceof Element))\n      return;\n    const row = e.target.closest(this.selectors.Row);\n    const cell = e.target.closest(this.selectors.Cell);\n    if (row && cell) {\n      const cellPosition = this.getColumnIndex(cell);\n      const rowPosition = this.getRowIndex(row);\n      this.debugLog(\"gridNavigation\", `Initial row position: ${rowPosition}`);\n      this.debugLog(\"gridNavigation\", `Initial cell position: ${cellPosition}`);\n      if (cellPosition === void 0 || rowPosition === void 0) {\n        this.debugLog(\n          \"verticalCellNavigation\",\n          \"row or cell position not found\"\n        );\n        return;\n      }\n      const direction = e.key === \"ArrowUp\" /* ArrowUp */ ? \"prev\" : \"next\";\n      if (rowPosition === 0 && direction === \"prev\") {\n        const currentRowGroup = (_a = row.parentElement) == null ? void 0 : _a.closest(\n          this.selectors.RowGroup\n        );\n        const siblingRowGroups = [\n          ...((_b = currentRowGroup == null ? void 0 : currentRowGroup.parentElement) == null ? void 0 : _b.children) || []\n        ];\n        const currentRowGroupIdx = siblingRowGroups.findIndex(\n          (el) => el === currentRowGroup\n        );\n        if (currentRowGroupIdx !== 0) {\n          const previousRowGroup = siblingRowGroups[currentRowGroupIdx - 1];\n          const rows = [\n            ...previousRowGroup.querySelectorAll(this.selectors.Row)\n          ];\n          const child2 = rows[rows.length - 1].children[cellPosition];\n          if (child2 && this.isFocusable(child2))\n            child2.focus();\n          return;\n        }\n      }\n      const siblingRows = [\n        ...((_c = row.parentElement) == null ? void 0 : _c.querySelectorAll(this.selectors.Row)) || []\n      ];\n      if (rowPosition === siblingRows.length - 1 && direction === \"next\") {\n        const currentRowGroup = (_d = row.parentElement) == null ? void 0 : _d.closest(\n          this.selectors.RowGroup\n        );\n        const siblingRowGroups = [\n          ...((_e = currentRowGroup == null ? void 0 : currentRowGroup.parentElement) == null ? void 0 : _e.children) || []\n        ];\n        const currentRowGroupIdx = siblingRowGroups.findIndex(\n          (el) => el === currentRowGroup\n        );\n        if (currentRowGroupIdx !== siblingRowGroups.length - 1) {\n          const nextRowGroup = siblingRowGroups[currentRowGroupIdx + 1];\n          const rows = [...nextRowGroup.querySelectorAll(this.selectors.Row)];\n          const child2 = rows[0].children[cellPosition];\n          if (child2 && this.isFocusable(child2))\n            child2.focus();\n          return;\n        }\n        return;\n      }\n      const destinationRow = this.findUntil(direction, row, this.selectors.Row);\n      if (!destinationRow)\n        return;\n      const child = destinationRow.children[cellPosition];\n      if (child && this.isFocusable(child))\n        child.focus();\n    }\n  }\n  /**\n   * Sending a row `Element` and then the first cell will be focused.\n   *\n   * If you want to focus the last cell then the row children can be passed in\n   * reversed order\n   */\n  focusOnFirstCell(el) {\n    for (let i = 0; i < el.length; i++) {\n      const child = el[i];\n      if (this.isFocusable(child)) {\n        child.focus();\n        return;\n      }\n    }\n  }\n  /**\n   * Get the column index of a `cell` based on the first `row` parent.\n   * `cellIndex` could be used, but it's not supported in HTML tables.\n   */\n  getColumnIndex(cell) {\n    var _a;\n    let position = 0;\n    const siblings = (_a = cell == null ? void 0 : cell.parentNode) == null ? void 0 : _a.children;\n    if (!siblings)\n      return void 0;\n    while (cell !== siblings[position] && siblings[position] !== void 0) {\n      position++;\n    }\n    if (siblings[position] === void 0) {\n      this.debugLog(\"getColumnIndex\", \"position finding was not successful\");\n      return void 0;\n    }\n    return position;\n  }\n  /**\n   * Get the row index of a `row` based\n   * on its sibling rows\n   */\n  getRowIndex(row) {\n    var _a;\n    let position = 0;\n    const siblings = (_a = row == null ? void 0 : row.parentNode) == null ? void 0 : _a.children;\n    if (!siblings)\n      return void 0;\n    while (row !== siblings[position] && siblings[position] !== void 0) {\n      position++;\n    }\n    if (siblings[position] === void 0) {\n      this.debugLog(\"getRowIndex\", \"position finding was not successful\");\n      return void 0;\n    }\n    return position;\n  }\n  /**\n   * Equivalent to prevUntil/nextUntil in jQuery\n   * https://api.jquery.com/prevUntil/\n   */\n  findUntil(direction, el, matchSelector, exitSelector) {\n    let element = el;\n    const method = direction === \"next\" ? \"nextSibling\" : \"previousSibling\";\n    while (element[method]) {\n      const sibling = element[method];\n      if (!sibling)\n        return null;\n      if (exitSelector && sibling instanceof Element && sibling.matches(exitSelector)) {\n        return null;\n      }\n      if (sibling instanceof Element && sibling.matches(matchSelector)) {\n        return sibling;\n      }\n      element = sibling;\n    }\n    return null;\n  }\n};\nexport {\n  DataGridNav\n};\n//# sourceMappingURL=index.mjs.map","// src/index.tsx\nimport { DataGridNav } from \"@table-nav/core\";\nfunction useTableNav(options) {\n  const nav = new DataGridNav(options);\n  return {\n    listeners: {\n      onKeyDown: (e) => nav.tableKeyDown(e),\n      onKeyUp: () => nav.tableKeyUp()\n    },\n    tableNav: nav\n  };\n}\nexport {\n  useTableNav\n};\n//# sourceMappingURL=index.mjs.map"],"names":["__defProp","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","__defNormalProp","obj","key","value","__spreadValues","a","b","prop","Selectors","DataGridNav","config","functionName","message","selectors","pageUpDown","debug","el","_a","cell","focusableWidgets","widgetIdx","nextFocusable","widgetToFocus","previousFocusable","target","direction","closeFocusable","row","rowChildren","firstKey","secondKey","siblings","rowToFocus","position","destinationRow","methodClbk","sibling","lastVisitedSibling","i","child","_b","_c","_d","_e","cellPosition","rowPosition","currentRowGroup","siblingRowGroups","currentRowGroupIdx","rows","child2","siblingRows","matchSelector","exitSelector","element","method","useTableNav","options","nav","e"],"mappings":"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"}